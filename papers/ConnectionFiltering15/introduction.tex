\section{Introduction}
\label{sec:intro} 

Mobile applications enjoy almost permanent connectivity and the
ability to exchange information with their own back-end and other
third-party servers.  This paper shows that much of this communication
delivers no value to the user of the application: disabling such
communication leaves the delivered application experience completely
intact.  Yet, this communication comes with costs such as bandwidth
charges, power consumption on the device, potential privacy breaches
and analytic data release, and the unsuspected presence of continued
communication between the device and remote organizations. In fact, we
observed that several applications silently spawn services that
communicate with third-party servers even when the application itself
is no longer active, with the user completely unaware that the spawned
services are still running in the background. 
% {\bf JR: Michael, if
%  you have some energy, more motivation why we don't like this
%  excessive communication would be a good fit here.}

This paper takes the first steps towards automatically identifying and
disabling these kinds of non-essential communications. We start by
analyzing communication patterns of
%in widely used mobile applications such as ten of the top fifteen most
popular applications in the Google Play App Store (twitter, WalMart,
Spotify, Pandora, etc.). Motivated by the significant
amount of non-essential communication we found in these applications, 
we develop a highly precise and scalable static analysis that can identify 
such non-essential communication automatically. We use our analysis to further 
investigate this unfortunate phenomenon and report on our findings. 
The following research questions drive this investigation:

%\vspace{0.1in}
\noindent 
{\bf RQ1: How frequently does non-essential communication occur in
  widely used mobile applications?}  To estimate the significance of
the problem, we conduct an empirical study that focuses on identifying
and investigating the nature of non-essential communication in thirteen of the 
top twenty 20 most-popular applications in Google Play.
%We focus on the two most
%common connection types: HTTP and socket.  
%The former two are
%used to communicate with various backend servers~-- the application's
%own and third parties'; the latter one is used to communicate with
%other applications and services running on the same device.

%\vspace{0.05in}
%\noindent\emph{Baseline Behavior:}
Our study has three major steps. First, we establish baseline
application behavior.  Towards this end, we record a
script triggering the application functionality via a series of
interactions with the application's user interface.  After each
interaction, the script records the
application state by capturing a screenshot of the device.
%\vspace{0.05in}
%\noindent\emph{Instrumentation:} 
We then instrument the application to log information
about each triggered connection statement, install the instrumented version on a mobile device and execute it using the recorded script.
%\vspace{0.05in}
%\noindent\emph{Disable Connections:} 
Finally, we iterate over all triggered connections, disabling each at a time.
%To disable a connection, we replace the connection statement  
%with a statement that throws an exception indicating connection failure, 
%i.e., the one that would be thrown when the device is in a disconnected mode. 
%
%\vspace{0.05in}
%\noindent\emph{Run Modified Application:} 
We install the modified
application, run it using the previously recorded script and compare obtained screenshots 
%Similarly to the approach
%in~\cite{Hornyack:Han:Jung:Schechter:Wetherall:CCS11}, the
%screenshots documenting the execution of the modified application are
%compared 
to those of the original run. 

We consider executions as
equivalent if they result in screenshots that differ only in the
content of advertisement information, messages in social network
applications such as twitter, and the device's status bar.  
%We also
%separately note connections that contribute to presenting
%advertisement content, if the analyzed application has any.

%\vspace{0.05in}
%\noindent\emph{Result Summary:} 
Our study reveals that around 70\% of
the \emph{exercised} connection statements are not essential~--- disabling
them has no noticeable effect on the observable application
functionality. Interestingly, only less than half of such non-essential connections correspond to communication initiated from the known advertisement and analytics (A\&A) packages included in the application; other statements are triggered by the core application itself. 
Thus, looking at the package information only is not sufficient for distinguishing between
essential and non-essential communication. 
% Slightly more than 25\% of these correspond to HTTP
%and socket communication. The rest correspond to RPC calls to internal
%services installed on the device: notably, but not exclusively, Google
%advertising and analytics, which further communicate with external
%services.  Moreover, in applications that present advertisement
%material, about 60\% of the connections that do affect the observable
%application behavior are used for advertising purposes only.
%{\bf JR: update.}

%\vspace{0.1in}
\noindent 
{\bf RQ2: Can non-essential communication be detected statically?}
Detailed investigation of multiple detected cases of non-essential
connections inspired us to develop a novel static application analysis technique that
can detect such connections automatically.  The core idea behind our
analysis is to look for cases when both connection success and failure are ``silently'' ignored by the application, i.e., when no information is propagated back to the user neither on success nor on   failure of the connection. 

We scope our analysis of the program control flow graph by considering the \emph{direct processing} of a connection statement. 
That includes \emph{forward stack processing} and \emph{backward stack processing} executions. 
The former one is the execution reachable after the connection statement but limited to processing of the Android runtime events that trigger the connection statement.
The latter is the execution that traverse the methods up the calls stack and is limited by the points at which the exception raised by the call statement and all related rethrown exceptions are handled. 


%that the processing associated with a non-essential
%connection statements does not directly 
%affect the user experience, i.e, no GIU elements are found 
% %on success
%%or failure, and a non-essential connection call will not cause
%%application exit on failure. 

%The static analysis first calculates all possible flows of control of
%the application during {\it failure handling} of the connection
%call. 
%Failure handling begins when the exception is caught 
%
%%For an exception $e$ of connection statement $s$ in method $m$,
%%failure handling is the set of methods on all possible call stacks for
%%$m$ that either pass the exception $e$ up the stack or handle $e$.
%Next, the static analysis calculates the set of methods that are
%reachable on successful forward processing of $s$ during the Android
%events that could trigger $s$.  

%The union of these two sets define our notion of {\it direct} success
%and failure processing of connection statement $s$.  
The direct processing is then
searched for method call invocations that could target a predefined
set of API calls that affect the user interface.  If such a call is
found, the connection statement is deemed essential.  Furthermore, 
if the exception is propagated back to the Android runtime (causing the application to exit), the connection call is deemed essential.
Otherwise, it is deemed non-essential.

%includes  exception is 
%a failure
%handling path includes a method that is an application event handler
%that does not handle the exception, then the application will
%propagate the exception to the Android runtime and could exit on the
%exception, and the connection call is deemed essential.

Our static analysis is designed to scale to large Android applications
and to conservatively approximate the behavior of dynamic constructs
such as reflection and missing semantics such as native methods.  The
analysis also reasons about application code reachable through Android
API calls and callbacks by analyzing each application in the context
of a rich model of the Android
API~\cite{Gordon:Kim:Perkins:Gilham:Nguyen:Rinard:NDSS15}. 

We perform intra-application analysis only, i.e., ignoring effects of RPC communication between multiple applications on the same device. Moreover, our technique is not designed to handle
%(1) \emph{optional} behaviors, for which failing connections are silently ignored, but successful connections result in presenting additional information to the user; 
%advertisement content usually falls into that category. 
\emph{stateful} communication patterns with external services, i.e., those when a connection attempt leaves the target in a state different from the one it had before, and further communication is influenced by the server's state. Our experiments show that both such cases are rare. 

%\vspace{0.05in}
\noindent 
{\bf RQ3: How well does static detection perform?}
To assess the precision and recall of our technique, we evaluate it on the ``truth set'' established during the in-depth analysis of thirteen popular applications from Google Play.
The results show that it features a high precision -- 93\% of the identified connection are indeed classified as non-essential during the manual analysis. Even though it is designed to be conservative, it is still able to identify  60\% of all non-essential connection in the studied application.
Only 2 connections in total are misclassified as non-essential: one is responsible for controlling the advertisement material presented by the Google Ads component installed on the device, and another -- for presenting images of additional apps that can be downloaded from Google Play. 

To gain further insights on the quality of our technique, we apply the technique on additional 47 top-popular applications from Google Play. For these applications, we inject failures in all connection statements deemed non-essential by our static analysis. We then employ humans to perform a \emph{usability assessment}: we provide them with two identical devices, one running the original and the other -- modified version of the application. We ask them to track and report on any observable differences between the two versions of the application. 

The results of our usability assessment are encouraging: there were no observable differences in 63.8\% of the application (30 cases). In 25.6\% of the applications (12 cases) differences where related to absence of functionality considered minor by the users, e.g., ads or decorating images. Only 10.6\% of the applications (5 cases) missed functional features considered essential by the users. 
These results imply that our technique produces actionable results that could already be applied to eliminate many cases of non-essential communication. 


%\vspace{0.05in}
\noindent 
{\bf RQ4: How often does non-essential communication occur in real-life applications and what are its most common sources?}
Inspired by the high precision of our technique, we apply it on the top 500 popular applications from Google Play. This experiment reveals that 46\% of connection sites encoded in these applications 
are deemed non-essential.
Most common sources of non-essential communication are various Google services for mobile developers. We conjecture 
that applications commonly register for various such services without eventually using them. 
Additional common targets are advertisement, analytics and gaming services. 

%\vspace{0.05in}
\noindent 
{\bf Significance of the Work.}  Our work focuses on benign mobile
applications that can be downloaded from popular application stores
and that are installed by millions of users.  By identifying and
highlighting application functionality hidden from the user, the goal
is to encourage application developers to produce more transparent and
trustworthy applications. The identification of potential privacy
violations in previous versions of popular Android
applications~\cite{Enck:Gilbert:Chun:Cox:Jung:McDaniel:Sheth:OSDI10,Egele:Kruegel:Kirda:Vign:NDSS11,Tripp:Rubin:SEC14} followed by the
elimination of these violations in current Android applications
provides encouraging evidence that such an improvement is feasible.

%\vspace{0.05in}
\noindent 
{\bf Contributions.}
The paper makes the following contributions:

\vspace{-0.05in}
\begin{enumerate}[leftmargin=0.5cm]\setlength{\itemsep}{-0.01in}

\item It sets \emph{a new problem} of distinguishing between essential and non-essential release of information by mobile applications in an automated manner. The goal is to improve the
transparency and trustworthiness of mobile applications.

\item It proposes \emph{a semi-automated dynamic approach} for detecting non-essential releases of information in Android applications which does not require access to the application source code. 
The approach relies on interactive injection of connection failures and identification of cases in which the injected failures do not affect the observable application functionality. 

\item It provides \emph{empirical evidence} for the prevalence of such non-essential connections in real-life applications. Specifically, it shows that 69\% of the connections attempted by thirteen top-popular free applications on Google Play fall into that category.    

\item It proposes \emph{a static technique} that operates on application binaries and identifies non-essential connections -- those where failures are not propagated back to the application's user. The technique is highly scalable and precise: out of 47 highly popular applications on Google Play, 
63.8\% worked without any interference and further 25.6\% work with only insignificant interference when 
disabling all connections identified by the technique.

% precision and recall of the technique is 93\% and 60\%, respectively, when evaluated against the empirically established truth set.       

\item It provides \emph{quantitative evidence} for the prevalence of non-essential connections in the 500 top-popular free applications on Google Play and identifies common sources of such communication. 

%, showing that 84\% of connections encoded in these applications can be deemed as non-essential.

\end{enumerate}

%% The remainder of the paper is structured as follows. Section~\ref{sec:study} describes the empirical study we conducted for gaining insight into the nature of information releases in mobile applications. Section~\ref{sec:analysis} presents the static analysis technique designed for identifying non-essential information releases. 
%% Section~\ref{sec:evaluation} discusses results of its evaluation on real-live examples. Section~\ref{sec:limitations} discusses the limitations and threats to validity of our work. Section~\ref{sec:related} presents the related work, while Section~\ref{sec:conclusions} concludes. 



