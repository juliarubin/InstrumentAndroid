\section{Introduction}
\label{sec:intro} 

Mobile applications enjoy almost permanent connectivity and the
ability to exchange information with their own back-end, third-party
servers and other applications installed on the same device.  This
paper shows that much of this communication delivers no value to the
user of the application --- disabling such communication leaves the
delivered application experience completely intact.  But this
communication comes with costs such as bandwidth charges, power
consumption on the device, potential privacy and analytic data
release, and the unsuspected presence of continued communication
between the device and remote organizations. We have even observed
applications that silently spawn services that communicate with
third-party servers {\em even when the application itself is no longer
active}, with the user completely unaware that the spawned services are
still running in the background.

This paper takes the first steps towards automatically identifying and
disabling these kinds of non-essential communications. We start by
identifying and disabling non-essential communication in 
widely used mobile applications such as ten of the top fifteen most
popular applications in the Google Play App Store (twitter, WalMart,
Spotify, Pandora, CandyCrush, etc.). Motivated by the significant
amount of non-essential communication we found in these applications, 
we next developed a static analysis that can automatically identify 
non-essential communication and used this analysis in our
further investigation of this unfortunate phenomenon. The following
research questions drive this investigation:

\vspace{0.1in}
\noindent 
{\bf RQ1: How frequently does non-essential communication occur in
  widely used mobile applications?}  To estimate the significance of
the problem, we conduct an empirical study that focuses on identifying
and investigating the nature of non-essential communication in ten
top-popular applications in Google Play.  We focus on the three most
common connection types: HTTP, socket and RPC.  The former two are
used to communicate with various backend servers -- the application's
own and third parties'; the latter one is used to communicate with
other applications and services running on the same device.

\noindent{\bf Baseline Behavior:} We first establish baseline
application behavior.  Similarly to the approach
in~\cite{Hornyack:Han:Jung:Schechter:Wetherall:CCS11}, we record a
script triggering the application functionality via a series of
interactions with the application's user interface.  After each
interaction, we capture a screenshot of the device to record the
application state.

\noindent{\bf Instrumentation:} We next instrument the application to log information
about triggered connection statements. The instrumented apk is then
installed and executed on a mobile device using the recorded script.

\noindent{\bf Disable Connections:} We disable each triggered connection
in turn by replacing the statement that establishes the connections 
with a statement that throws an exception that indicates that the
connection failed because the device was in airplane mode. 

\noindent{\bf Run Modified Application:} We install the modified
application and run it using the previously recorded script. The
screenshots documenting the execution of the modified application are
compared to those of the original one. We consider executions as
equivalent if they result in screenshots that differ only in the
content of advertisement information, messages in social network
applications such as twitter, and the device's status bar.  We also
separately note connections that contribute to presenting
advertisement content, if the analyzed application has any.

\noindent{\bf Result Summary:} Our study reveals that around 65\% of
the exercised connection statements are not essential --- disabling
them has no noticeable effect on the observable application
functionality.  Slightly more than 25\% of these correspond to HTTP
and socket communication. The rest correspond to RPC calls to internal
services installed on the device: notably, but not exclusively, Google
advertising and analytics, which further communicate with external
services.  Moreover, in applications that present advertisement
material, about 60\% of the connections that do affect the observable
application behavior are used for advertising purposes only.

\vspace{0.1in}
\noindent 
{\bf RQ2: Can non-essential communication be detected statically?}
Inspired by our findings, we develop a novel tatic application
analysis that can detect connection failures that are ``silently''
ignored by the application, i.e., when information about a connection
failure is not propagated back to the end user.  The static analysis
classifies each connection call by inspecting the execution of the
application during {\it failure handling} of the connection call.
Failure handling begins when the exception is propagated to the
connection call and ends when the execution exits the exception
handler of the exception or the handlers of all rethrown exceptions
that are raised during handling.  could affect the user interface
through a call to a predefined set of API calls, then we classify the
connection call to be {\em essential}.  Also, if there is a failure handing
path that could exit the program, because a thrown exception
propagates back into the Android runtime, the analysis classifies the
connection call as essential.

Our static analysis is designed to scale to large Android applications
and to conservatively approximate the behavior of dynamic constructs
such as reflection and missing semantics such as native methods.  The
analysis also reasons about application code reachable through Android
API calls and callbacks by analyzing each application in the context
of a rich model of the Android
API~\cite{Gordon:Kim:Perkins:Gilham:Nguyen:Rinard:NDSS15}. 

There are two special cases that our technique is not designed to handle: (1) \emph{optional} behaviors, for which failing connections are silently ignored, but successful connections result in presenting additional information to the user; 
advertisement content usually falls into that category. (2) \emph{stateful} communication, for which failures leave the 
connection target in a state different from the one it has after a successful communication, and further communication is influenced by the server's state. Our experiments show that such cases are rare. 

\vspace{0.1in}
\noindent 
{\bf RQ3: How well does static detection perform?}
To assess the quality of our technique, we evaluate it on the ``truth set'' established during our empirical analysis of applications from Google Play.
The results show that it features a high precision -- 83\% of the identified connection (64 out of 82) are indeed classified as non-essential during the manual analysis. Even though it is designed to be conservative, it is still able to identify  64\% of all non-essential connection (64 out of 106).
There are 18 connections in total that are miss-classified as non-essential. Out of these, 16 correspond to optional application behaviors and the remaining 2 -- to stateful communication. Counting advertisement content as non-essential
gives the overall precision and recall of 90\% and 65\%, respectively.  

\vspace{0.1in}
\noindent 
{\bf RQ4: How often does non-essential communication occur in real-life applications and what are its most common destinations?}
Applying the analysis on the top 500 popular applications from Google Play reveals that 84\% of connection sites encoded in these applications can be deemed non-essential.
Most common target of non-essential communication are various Google services for mobile developers. We conjecture 
that applications commonly register for various such services without eventually using them. 
Additional common targets are advertisement, analytics and gaming services. 

\vspace{0.1in}
\noindent 
{\bf Significance of the Work.}  Our work focuses on benign mobile
applications that can be downloaded from popular application stores
and that are installed by millions of users.  By identifying and
highlighting application functionality hidden from the user, the goal
is to encourage application developers to produce more transparent and
trustworthy applications. The identification of potential privacy
violations in previous versions of popular Android
applications~\cite{Enck:Gilbert:Chun:Cox:Jung:McDaniel:Sheth:OSDI10,Egele:Kruegel:Kirda:Vign:NDSS11,Tripp:Rubin:SEC14} followed by the
elimination of these violations in current Android applications
provides encouraging evidence that such an improvement is feasible.

\vspace{0.1in}
\noindent 
{\bf Contributions.}
The paper makes the following contributions:

\noindent 1.
It sets \emph{a new problem} of distinguishing between essential and non-essential release of information by mobile applications in an automated manner. The goal is to improve the
transparency and trustworthyness of mobile applications.

\noindent 2.
It proposes \emph{a semi-automated dynamic approach} for detecting non-essential releases of information in Android applications which does not require access to the application source code. 
The approach relies on interactive injection of connection failures and identification of cases in which the injected failures do not affect the observable application functionality. 

\noindent 3.
It provides \emph{empirical evidence} for the prevalence of such non-essential connections in real-life applications. Specifically, it shows that 65\% of the connections attempted by ten top-popular free applications on Google Play fall into that category.    

\noindent 4.
It proposes \emph{a static technique} that operates on application binaries and identifies non-essential connections -- those where failures are not propagated back to the application's user. The precision and recall of the technique is 83\% and 63\%, respectively, when evaluated against the empirically established truth set. 
The precision and recall increases to 90\% and 64\%, receptively, when considering the advertisement content as non-essential.

\noindent 5.
It provides \emph{quantitative evidence} for the prevalence of non-essential connections in the 500 top-popular free applications on Google Play, showing that 84\% of connections encoded in these applications can be deemed as non-essential.

The remainder of the paper is structured as follows. Section~\ref{sec:study} describes the empirical study we conducted for gaining insight into the nature of information releases in mobile applications. Section~\ref{sec:analysis} presents the static analysis technique designed for identifying non-essential information releases. 
Section~\ref{sec:evaluation} discusses results of its evaluation on real-live examples. Section~\ref{sec:limitations} discusses the limitations and threats to validity of our work. Section~\ref{sec:related} presents the related work, while Section~\ref{sec:conclusions} concludes. 



